/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
*/

import React, { useEffect } from 'react'
import { useGLTF, useTexture } from '@react-three/drei'
import * as THREE from 'three'

export function Model(props) {
  const { nodes, materials } = useGLTF('/iphone17promax.glb')
  
  // 1. –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—Å—Ç—É—Ä—É –¥–ª—è —ç–∫—Ä–∞–Ω–∞
  // –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Ñ–∞–π–ª wallpaper.jpg –ª–µ–∂–∏—Ç –≤ –ø–∞–ø–∫–µ public!
  const screenTexture = useTexture('/wallpaper.jpg')
  screenTexture.flipY = false // –ò–Ω–æ–≥–¥–∞ —Ç–µ–∫—Å—Ç—É—Ä—ã –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—ã, —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç

  useEffect(() => {
    // –¶–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–±—Ä–∞–ª —é–∑–µ—Ä
    const userColor = new THREE.Color(props.itemColor)

    // --- –ó–û–ù–ê –≠–ö–°–ü–ï–†–ò–ú–ï–ù–¢–û–í ---
    
    // –°–Æ–î–ê –º—ã –≤–ø–∏—à–µ–º –∏–º—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –∫–æ—Ä–ø—É—Å–∞, –∫–æ–≥–¥–∞ –Ω–∞–π–¥–µ–º –µ–≥–æ –∫–ª–∏–∫–æ–º.
    // –ù–∞–ø—Ä–∏–º–µ—Ä: materials.–ö–æ—Ä–ø—É—Å–ù–∞–∑–≤–∞–Ω–∏–µ
    
    // –°–Æ–î–ê –º—ã –≤–ø–∏—à–µ–º –∏–º—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞ —ç–∫—Ä–∞–Ω–∞.
    // –ù–∞–ø—Ä–∏–º–µ—Ä: materials.–≠–∫—Ä–∞–Ω–ù–∞–∑–≤–∞–Ω–∏–µ

  }, [props.itemColor, materials])

  // –§—É–Ω–∫—Ü–∏—è-–¥–µ—Ç–µ–∫—Ç–æ—Ä
  const handlePartClick = (e, name, materialName) => {
    e.stopPropagation()
    console.log('-----------------------')
    console.log('üßä –¢—ã –∫–ª–∏–∫–Ω—É–ª –ø–æ —á–∞—Å—Ç–∏:', name)
    console.log('üé® –ò–º—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞:', materialName)
    console.log('-----------------------')
    
    // –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞: –º–∏–≥–Ω–µ—Ç –∫—Ä–∞—Å–Ω—ã–º
    e.object.material.color.set('red')
    alert(`–≠—Ç–æ –º–∞—Ç–µ—Ä–∏–∞–ª: ${materialName}. –°–∫–æ–ø–∏—Ä—É–π –µ–≥–æ –∏–º—è –∏–∑ –∫–æ–Ω—Å–æ–ª–∏!`)
  }

  return (
    <group {...props} dispose={null}>
      {/* –Ø –≤–µ—Ä–Ω—É–ª –≤—Å–µ –º–µ—à–∏, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –Ω–∞ –Ω–∏—Ö —Ç—ã–∫–∞—Ç—å */}
      {Object.keys(nodes).map((key) => {
        if (nodes[key].type === 'Mesh') {
          return (
            <mesh 
              key={key}
              geometry={nodes[key].geometry}
              material={materials[nodes[key].material.name]}
              // –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ: —è —É–±—Ä–∞–ª –∂–µ—Å—Ç–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, —á—Ç–æ–±—ã –æ–Ω–∏ –±—Ä–∞–ª–∏—Å—å –∏–∑ —Ñ–∞–π–ª–∞
              // –ù–æ –µ—Å–ª–∏ –º–æ–¥–µ–ª—å "—Ä–∞–∑–≤–∞–ª–∏—Ç—Å—è", –≤–µ—Ä–Ω–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–ø—Å—ã –∏–∑ —Å–≤–æ–µ–≥–æ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∞–π–ª–∞
              position={nodes[key].position}
              rotation={nodes[key].rotation}
              scale={nodes[key].scale}
              onClick={(e) => handlePartClick(e, key, nodes[key].material.name)}
            />
          )
        }
        return null
      })}
    </group>
  )
}

useGLTF.preload('/iphone17promax.glb')